uprobe:/mnt/linuxstorage/openssl/libcrypto.so:PBMAC1_PBKDF2_HMAC
{
  printf("=== HIT pid=%d tid=%d comm=%s ===\n", pid, tid, comm);



  // Dump context while it's stopped
  system("readlink /proc/%d/exe > /tmp/exe.%d 2>/dev/null", pid, pid);
  system("cat /proc/%d/maps > /tmp/maps.%d 2>/dev/null", pid, pid);

  // Optional: confirm file sizes (helps debug if still empty)
  system("wc -c /tmp/exe.%d /tmp/maps.%d 2>/dev/null", pid, pid);


  // Print raw stack for offline symbolization
  print(ustack(30));

  // Remove exit() if you want to keep capturing more hits
  exit();
}
