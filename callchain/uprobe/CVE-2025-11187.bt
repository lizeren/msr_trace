uprobe:/mnt/linuxstorage/openssl/libcrypto.so:PBMAC1_PBKDF2_HMAC
/comm == "openssl"/
{
  printf("=== HIT pid=%d tid=%d comm=%s ===\n", pid, tid, comm);

  // Dump the exact binary and mappings while the process still exists
  system("readlink /proc/%d/exe > /tmp/exe.%d 2>/dev/null", pid, pid);
  system("cat /proc/%d/maps > /tmp/maps.%d 2>/dev/null", pid, pid);

  // Print the raw stack (we'll symbolize it offline)
  print(ustack(30));

  // Optional: stop after first hit to keep it simple
  exit();
}
