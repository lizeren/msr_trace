uprobe:/mnt/linuxstorage/openssl/libcrypto.so:CRYPTO_ocb128_encrypt
{
  printf("=== HIT CRYPTO_ocb128_encrypt pid=%d tid=%d comm=%s ===\n", pid, tid, comm);

// Freeze the process so /proc/<pid>/... stays valid
  system("kill -STOP %d 2>/dev/null", pid);
  // Snapshot context while process still exists
  system("readlink /proc/%d/exe > /tmp/exe.%d 2>/dev/null", pid, pid);
  system("cat /proc/%d/maps > /tmp/maps.%d 2>/dev/null", pid, pid);

// Let it run again
  system("kill -CONT %d 2>/dev/null", pid);
  // Raw stack (symbolize offline)
  print(ustack(30));

  exit();
}
