uprobe:/mnt/linuxstorage/openssl/libcrypto.so:0x378e23
/comm == "openssl"/
{
  printf("=== HIT ossl_ess_get_signing_cert pid=%d tid=%d comm=%s ===\n", pid, tid, comm);

  // Freeze the process so /proc/<pid>/... stays valid
  system("kill -STOP %d 2>/dev/null", pid);

  // Dump context while it's stopped
  system("readlink /proc/%d/exe > /tmp/exe.%d 2>/dev/null", pid, pid);
  system("cat /proc/%d/maps > /tmp/maps.%d 2>/dev/null", pid, pid);

  // Optional: confirm file sizes (helps debug if still empty)
  system("wc -c /tmp/exe.%d /tmp/maps.%d 2>/dev/null", pid, pid);

  // Let it run again
  system("kill -CONT %d 2>/dev/null", pid);

  // Print raw stack for offline symbolization
  print(ustack(30));

  // Remove exit() if you want to keep capturing more hits
  exit();
}
